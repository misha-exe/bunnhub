<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bunhub - Sports Hub</title>
    <style>
        :root {
            --bg: #F8F5F0;
            --secondary: #EEEEEE;
            --accent: #F56E0F;
            --text: #1a1a1a;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }
        body { background-color: var(--bg); color: var(--text); overflow-x: hidden; }

        /* Navigation & Headers */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 20px; background: white; position: sticky; top: 0; z-index: 100;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .logo { font-weight: 800; font-size: 1.2rem; letter-spacing: 1px; }
        .logo span { color: var(--accent); }
        .admin-btn { background: none; border: none; cursor: pointer; font-size: 20px; }

        /* Age Gate Overlay */
        #age-gate {
            position: fixed; inset: 0; background: var(--bg); z-index: 1000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 30px; text-align: center;
        }
        .gate-card { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .btn-primary { 
            background: var(--accent); color: white; border: none; 
            padding: 12px 30px; border-radius: 8px; font-weight: bold; margin-top: 20px; cursor: pointer;
        }

        /* Video Grid */
        .container { padding: 15px; }
        .tabs { display: flex; gap: 20px; margin-bottom: 15px; border-bottom: 2px solid var(--secondary); padding-bottom: 10px; }
        .tab { font-weight: 600; color: #888; cursor: pointer; position: relative; }
        .tab.active { color: var(--text); }
        .tab.active::after { content: ''; position: absolute; bottom: -12px; left: 0; width: 100%; height: 3px; background: var(--accent); }

        .video-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .video-card { background: white; border-radius: 12px; overflow: hidden; cursor: pointer; position: relative; }
        .thumb-container { position: relative; width: 100%; aspect-ratio: 16/9; background: #ddd; }
        .thumb-container img { width: 100%; height: 100%; object-fit: cover; }
        .duration { position: absolute; bottom: 8px; right: 8px; background: rgba(0,0,0,0.8); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; }
        .video-info { padding: 8px; }
        .video-title { font-size: 0.85rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* Views */
        .view { display: none; }
        .view.active { display: block; }

        /* Admin Page */
        .admin-form { display: flex; flex-direction: column; gap: 15px; max-width: 400px; margin: 0 auto; }
        input { padding: 12px; border: 2px solid var(--secondary); border-radius: 8px; outline: none; }
        input:focus { border-color: var(--accent); }

        /* Player Page */
        .player-container { width: 100%; background: black; aspect-ratio: 16/9; position: relative; }
        video { width: 100%; height: 100%; }
        .play-overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); }
        .play-trigger { width: 60px; height: 60px; background: var(--accent); border-radius: 50%; border: none; color: white; font-size: 24px; cursor: pointer; }

        /* Ad Overlay */
        #ad-view {
            position: fixed; inset: 0; background: white; z-index: 2000; display: none;
        }
        #ad-frame { width: 100%; height: 100%; border: none; }
        #close-ad { 
            position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.5); 
            color: white; border: none; width: 40px; height: 40px; border-radius: 50%; 
            display: none; cursor: pointer; z-index: 2100; font-weight: bold;
        }

        .back-btn { background: var(--secondary); border: none; padding: 8px 15px; border-radius: 5px; margin-bottom: 10px; cursor: pointer; }
    </style>
</head>
<body>

    <!-- Age Gate -->
    <div id="age-gate">
        <div class="gate-card">
            <h2>BUN<span>HUB</span></h2>
            <p style="margin: 15px 0; color: #666;">You must be 18+ to view this content.</p>
            <button class="btn-primary" onclick="dismissAgeGate()">I AM 18+ ENTER</button>
        </div>
    </div>

    <!-- Main App Structure -->
    <header>
        <div class="logo">BUN<span>HUB</span></div>
        <button class="admin-btn" onclick="showView('admin-login')">⚙️</button>
    </header>

    <!-- Home View -->
    <main id="home-view" class="view container active">
        <div class="tabs">
            <div class="tab active">Trending</div>
            <div class="tab">Highlights</div>
            <div class="tab">Live</div>
        </div>
        <div id="video-grid" class="video-grid">
            <!-- Videos injected by JS -->
        </div>
    </main>

    <!-- Player View -->
    <div id="player-view" class="view">
        <div class="container">
            <button class="back-btn" onclick="showView('home-view')">← Back</button>
            <div class="player-container">
                <video id="main-video-player" playsinline></video>
                <div class="play-overlay" id="play-overlay">
                    <button class="play-trigger" onclick="handlePlayClick()">▶</button>
                </div>
            </div>
            <h2 id="player-title" style="margin-top: 15px;"></h2>
        </div>
    </div>

    <!-- Admin Login View -->
    <div id="admin-login" class="view container">
        <button class="back-btn" onclick="showView('home-view')">← Cancel</button>
        <h3>Admin Access</h3>
        <div class="admin-form" style="margin-top:20px;">
            <input type="password" id="admin-pass" placeholder="Enter Admin Password">
            <button class="btn-primary" onclick="loginAdmin()">Login</button>
        </div>
    </div>

    <!-- Admin Upload View -->
    <div id="admin-upload" class="view container">
        <button class="back-btn" onclick="showView('home-view')">← Logout</button>
        <h3>Upload Video</h3>
        <div class="admin-form" style="margin-top:20px;">
            <input type="text" id="vid-title" placeholder="Video Title">
            <input type="file" id="vid-file" accept="video/*">
            <p id="upload-status" style="font-size: 12px; color: var(--accent);"></p>
            <button class="btn-primary" onclick="handleUpload()">Upload to Library</button>
        </div>
    </div>

    <!-- Ad Overlay -->
    <div id="ad-view">
        <button id="close-ad" onclick="closeAd()">✕</button>
        <iframe id="ad-frame"></iframe>
    </div>

    <script>
        // --- DATA & STATE ---
        let videos = [
            { id: 1, title: "Epic Soccer Goals", duration: "5:12", thumb: "https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=400", url: "https://www.w3schools.com/html/mov_bbb.mp4" },
            { id: 2, title: "NBA Top Plays", duration: "6:45", thumb: "https://images.unsplash.com/photo-1546519638-68e109498ffc?w=400", url: "https://www.w3schools.com/html/movie.mp4" }
        ];

        let currentVideo = null;
        const AD_DIRECT_LINK = "https://www.google.com"; // Replace with your direct link

        // --- CORE FUNCTIONS ---
        function dismissAgeGate() {
            document.getElementById('age-gate').style.display = 'none';
            renderGrid();
        }

        function showView(viewId) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.getElementById(viewId).classList.add('active');
            if(viewId === 'home-view') renderGrid();
        }

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function renderGrid() {
            const grid = document.getElementById('video-grid');
            grid.innerHTML = '';
            const shuffled = shuffle([...videos]);
            
            shuffled.forEach(vid => {
                const card = document.createElement('div');
                card.className = 'video-card';
                card.onclick = () => openPlayer(vid);
                card.innerHTML = `
                    <div class="thumb-container">
                        <img src="${vid.thumb}" alt="${vid.title}">
                        <div class="duration">${vid.duration}</div>
                    </div>
                    <div class="video-info">
                        <div class="video-title">${vid.title}</div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function openPlayer(vid) {
            currentVideo = vid;
            document.getElementById('player-title').innerText = vid.title;
            const player = document.getElementById('main-video-player');
            player.src = vid.url;
            player.load();
            document.getElementById('play-overlay').style.display = 'flex';
            showView('player-view');
        }

        // --- AD LOGIC ---
        function handlePlayClick() {
            const adView = document.getElementById('ad-view');
            const adFrame = document.getElementById('ad-frame');
            const closeBtn = document.getElementById('close-ad');

            // 1. Show Ad UI
            adView.style.display = 'block';
            adFrame.src = AD_DIRECT_LINK;
            closeBtn.style.display = 'none';

            // 2. 5 Second Logic
            setTimeout(() => {
                closeBtn.style.display = 'block';
            }, 5000);
        }

        function closeAd() {
            document.getElementById('ad-view').style.display = 'none';
            document.getElementById('ad-frame').src = '';
            document.getElementById('play-overlay').style.display = 'none';
            document.getElementById('main-video-player').play();
        }

        // --- ADMIN & UPLOAD LOGIC ---
        function loginAdmin() {
            const pass = document.getElementById('admin-pass').value;
            if(pass === "admin123") { // Example pass
                showView('admin-upload');
            } else {
                alert("Incorrect Password");
            }
        }

        async function handleUpload() {
            const title = document.getElementById('vid-title').value;
            const fileInput = document.getElementById('vid-file');
            const status = document.getElementById('upload-status');

            if(!title || !fileInput.files[0]) return alert("Fill all fields");

            status.innerText = "Processing thumbnail...";
            const file = fileInput.files[0];
            const url = URL.createObjectURL(file);

            // Generate thumbnail from video
            const thumb = await generateThumbnail(url);
            
            const newVid = {
                id: Date.now(),
                title: title,
                duration: "New",
                thumb: thumb,
                url: url
            };

            videos.push(newVid);
            status.innerText = "Upload Successful!";
            setTimeout(() => {
                showView('home-view');
                status.innerText = "";
            }, 1000);
        }

        function generateThumbnail(videoUrl) {
            return new Promise((resolve) => {
                const video = document.createElement('video');
                video.src = videoUrl;
                video.load();
                video.currentTime = 1; // Capture at 1 second
                video.onloadeddata = () => {
                    setTimeout(() => {
                        const canvas = document.createElement('canvas');
                        canvas.width = 640;
                        canvas.height = 360;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                        resolve(canvas.toDataURL('image/jpeg'));
                    }, 500);
                };
            });
        }
    </script>
</body>
</html>